<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buzzy</title>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1471423857815501" 
            crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-1471423857815501">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Removed Lucide React - using Unicode symbols instead -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics.js';
        
        window.firebaseConfig = {
            apiKey: "AIzaSyB4FGk7EMd8np2opg19e7E_Ole5k2YR_kA",
            authDomain: "buzzy-fe536.firebaseapp.com",
            projectId: "buzzy-fe536",
            storageBucket: "buzzy-fe536.firebasestorage.app",
            messagingSenderId: "356922809670",
            appId: "1:356922809670:web:800b835e31cb774a165947",
            measurementId: "G-0GPRSWJ7T6"
        };
        
        const app = initializeApp(window.firebaseConfig);
        const analytics = getAnalytics(app);
        
        window.firebaseApp = app;
        window.firebaseAnalytics = analytics;
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .slider::-webkit-slider-thumb {
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #6366f1;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .slider::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #6366f1;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .slider {
            background: transparent;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .slider::-webkit-slider-track {
            background: currentColor;
            height: 8px;
            border-radius: 4px;
        }
        
        .slider::-moz-range-track {
            background: currentColor;
            height: 8px;
            border-radius: 4px;
            border: none;
        }

        /* Ad Styles */
        .ad-container {
            background: linear-gradient(135deg, #f0f4f8, #e2e8f0);
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 8px;
            margin: 16px 0;
            position: relative;
            width: 100%;
        }
        
        .ad-container::before {
            content: 'Advertisement';
            position: absolute;
            top: 2px;
            right: 8px;
            font-size: 10px;
            color: #9ca3af;
            font-weight: 500;
        }

        .adsbygoogle {
            border-radius: 8px;
            overflow: hidden;
        }

        /* Mobile first - responsive ad containers */
        .ad-banner {
            min-height: 100px;
        }
        
        .ad-square {
            min-height: 250px;
            max-width: 300px;
            margin: 16px auto;
        }

        /* Tablet and up */
        @media (min-width: 640px) {
            .ad-banner {
                min-height: 120px;
            }
            .ad-square {
                min-height: 280px;
            }
        }

        /* Desktop responsive improvements */
        @media (min-width: 1024px) {
            .ad-banner {
                max-width: 728px;
                min-height: 90px;
                margin: 16px auto;
            }
            .ad-square {
                max-width: 336px;
                min-height: 280px;
                margin: 16px auto;
            }
        }
    </style>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel" data-type="module">
        const { useState, useRef, useCallback } = React;
        
        // Simple icon components using Unicode symbols
        const Play = () => React.createElement('span', null, '▶️');
        const Square = () => React.createElement('span', null, '⏹️');
        const Headphones = () => React.createElement('span', null, '🎧');
        const Volume2 = () => React.createElement('span', null, '🔊');
        const Settings = () => React.createElement('span', null, '⚙️');
        const Music = () => React.createElement('span', null, '🎵');
        const Brain = () => React.createElement('span', null, '🧠');
        const Heart = () => React.createElement('span', null, '❤️');
        const Search = () => React.createElement('span', null, '🔍');
        const Plus = () => React.createElement('span', null, '➕');
        const X = () => React.createElement('span', null, '❌');
        const Trash2 = () => React.createElement('span', null, '🗑️');

        // Ad Components
        const ResponsiveAdBanner = ({ slot, style = {} }) => {
            React.useEffect(() => {
                // Use requestIdleCallback for non-blocking ad loading
                const loadAd = () => {
                    try {
                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.log('AdSense error:', e);
                    }
                };

                if (window.requestIdleCallback) {
                    window.requestIdleCallback(loadAd, { timeout: 2000 });
                } else {
                    setTimeout(loadAd, 100);
                }
            }, []);

            return React.createElement('div', {
                className: 'ad-container ad-banner my-4 flex justify-center',
                style: style
            }, [
                React.createElement('ins', {
                    key: 'ad',
                    className: 'adsbygoogle',
                    style: { display: 'block', width: '100%', height: 'auto' },
                    'data-ad-client': 'ca-pub-1471423857815501',
                    'data-ad-slot': slot || '1234567890',
                    'data-ad-format': 'auto',
                    'data-full-width-responsive': 'true'
                })
            ]);
        };

        const SquareAd = ({ slot }) => {
            React.useEffect(() => {
                // Use requestIdleCallback for non-blocking ad loading
                const loadAd = () => {
                    try {
                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.log('AdSense error:', e);
                    }
                };

                if (window.requestIdleCallback) {
                    window.requestIdleCallback(loadAd, { timeout: 2000 });
                } else {
                    setTimeout(loadAd, 100);
                }
            }, []);

            return React.createElement('div', {
                className: 'ad-container ad-square my-4 flex justify-center items-center'
            }, [
                React.createElement('ins', {
                    key: 'ad',
                    className: 'adsbygoogle',
                    style: { display: 'block', width: '100%', height: 'auto' },
                    'data-ad-client': 'ca-pub-1471423857815501',
                    'data-ad-slot': slot || '0987654321',
                    'data-ad-format': 'auto',
                    'data-full-width-responsive': 'true'
                })
            ]);
        };
        
        // Inline the entire app to avoid module loading issues
        const useAudioEngine = () => {
            const [isPlaying, setIsPlaying] = useState(false);
            const [leftFreq, setLeftFreq] = useState(440);
            const [rightFreq, setRightFreq] = useState(440);
            const [leftVolume, setLeftVolume] = useState(0.1);
            const [rightVolume, setRightVolume] = useState(0.1);
            const [waveType, setWaveType] = useState('sine');
            
            const audioContextRef = useRef(null);
            const leftOscillatorRef = useRef(null);
            const rightOscillatorRef = useRef(null);
            const leftGainRef = useRef(null);
            const rightGainRef = useRef(null);
            const mergerRef = useRef(null);

            const initializeAudio = useCallback(() => {
                if (!audioContextRef.current) {
                    audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();
                }
                return audioContextRef.current;
            }, []);

            const startAudio = useCallback(async () => {
                const audioContext = initializeAudio();
                
                if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                }

                leftOscillatorRef.current = audioContext.createOscillator();
                rightOscillatorRef.current = audioContext.createOscillator();
                leftGainRef.current = audioContext.createGain();
                rightGainRef.current = audioContext.createGain();
                mergerRef.current = audioContext.createChannelMerger(2);
                
                leftOscillatorRef.current.type = waveType;
                leftOscillatorRef.current.frequency.setValueAtTime(leftFreq, audioContext.currentTime);
                leftGainRef.current.gain.setValueAtTime(leftVolume, audioContext.currentTime);
                
                rightOscillatorRef.current.type = waveType;
                rightOscillatorRef.current.frequency.setValueAtTime(rightFreq, audioContext.currentTime);
                rightGainRef.current.gain.setValueAtTime(rightVolume, audioContext.currentTime);
                
                leftOscillatorRef.current.connect(leftGainRef.current);
                leftGainRef.current.connect(mergerRef.current, 0, 0);
                rightOscillatorRef.current.connect(rightGainRef.current);
                rightGainRef.current.connect(mergerRef.current, 0, 1);
                mergerRef.current.connect(audioContext.destination);
                
                leftOscillatorRef.current.start();
                rightOscillatorRef.current.start();
                
                setIsPlaying(true);
            }, [leftFreq, rightFreq, leftVolume, rightVolume, waveType]);

            const stopAudio = useCallback(() => {
                if (leftOscillatorRef.current) {
                    leftOscillatorRef.current.stop();
                    leftOscillatorRef.current.disconnect();
                    leftOscillatorRef.current = null;
                }
                
                if (rightOscillatorRef.current) {
                    rightOscillatorRef.current.stop();
                    rightOscillatorRef.current.disconnect();
                    rightOscillatorRef.current = null;
                }
                
                if (leftGainRef.current) {
                    leftGainRef.current.disconnect();
                    leftGainRef.current = null;
                }
                
                if (rightGainRef.current) {
                    rightGainRef.current.disconnect();
                    rightGainRef.current = null;
                }
                
                if (mergerRef.current) {
                    mergerRef.current.disconnect();
                    mergerRef.current = null;
                }
                
                setIsPlaying(false);
            }, []);

            const updateFrequency = useCallback((channel, frequency) => {
                if (!audioContextRef.current || (!leftOscillatorRef.current && !rightOscillatorRef.current)) {
                    return;
                }

                // Use requestAnimationFrame to avoid blocking main thread
                requestAnimationFrame(() => {
                    const audioContext = audioContextRef.current;
                    if (!audioContext) return;
                    
                    if (channel === 'left' && leftOscillatorRef.current) {
                        try {
                            // Stop current left oscillator
                            leftOscillatorRef.current.stop();
                            leftOscillatorRef.current.disconnect();
                            
                            // Create new left oscillator with current wave type
                            leftOscillatorRef.current = audioContext.createOscillator();
                            leftOscillatorRef.current.type = waveType;
                            leftOscillatorRef.current.frequency.setValueAtTime(frequency, audioContext.currentTime);
                            
                            // Reconnect
                            leftOscillatorRef.current.connect(leftGainRef.current);
                            leftOscillatorRef.current.start();
                        } catch (e) {
                            console.warn('Left oscillator update error:', e);
                        }
                    } else if (channel === 'right' && rightOscillatorRef.current) {
                        try {
                            // Stop current right oscillator
                            rightOscillatorRef.current.stop();
                            rightOscillatorRef.current.disconnect();
                            
                            // Create new right oscillator with current wave type
                            rightOscillatorRef.current = audioContext.createOscillator();
                            rightOscillatorRef.current.type = waveType;
                            rightOscillatorRef.current.frequency.setValueAtTime(frequency, audioContext.currentTime);
                            
                            // Reconnect
                            rightOscillatorRef.current.connect(rightGainRef.current);
                            rightOscillatorRef.current.start();
                        } catch (e) {
                            console.warn('Right oscillator update error:', e);
                        }
                    }
                });
            }, [waveType]);

            const updateVolume = useCallback((channel, volume) => {
                if (channel === 'left' && leftGainRef.current) {
                    leftGainRef.current.gain.setValueAtTime(
                        volume, 
                        audioContextRef.current.currentTime
                    );
                } else if (channel === 'right' && rightGainRef.current) {
                    rightGainRef.current.gain.setValueAtTime(
                        volume, 
                        audioContextRef.current.currentTime
                    );
                }
            }, []);

            const applyFrequency = useCallback((freq, channel = 'both') => {
                // Use setTimeout to debounce rapid frequency changes
                setTimeout(() => {
                    if (channel === 'both' || channel === 'left') {
                        setLeftFreq(freq);
                        if (audioContextRef.current && leftOscillatorRef.current) {
                            updateFrequency('left', freq);
                        }
                    }
                    if (channel === 'both' || channel === 'right') {
                        setRightFreq(freq);
                        if (audioContextRef.current && rightOscillatorRef.current) {
                            updateFrequency('right', freq);
                        }
                    }
                }, 0);
            }, [updateFrequency]);

            const applyBinauralBeat = useCallback((leftFreqValue, rightFreqValue) => {
                setLeftFreq(leftFreqValue);
                setRightFreq(rightFreqValue);
                
                // Only update frequencies if currently playing
                if (audioContextRef.current && leftOscillatorRef.current && rightOscillatorRef.current) {
                    updateFrequency('left', leftFreqValue);
                    updateFrequency('right', rightFreqValue);
                }
            }, [updateFrequency]);

            const updateWaveType = useCallback((newWaveType) => {
                setWaveType(newWaveType);
                
                // Use requestAnimationFrame to avoid blocking main thread
                requestAnimationFrame(() => {
                    // Recreate oscillators with new wave type if playing
                    if (audioContextRef.current && (leftOscillatorRef.current || rightOscillatorRef.current)) {
                        const audioContext = audioContextRef.current;
                        
                        try {
                            if (leftOscillatorRef.current) {
                                const currentLeftFreq = leftFreq;
                                leftOscillatorRef.current.stop();
                                leftOscillatorRef.current.disconnect();
                                
                                leftOscillatorRef.current = audioContext.createOscillator();
                                leftOscillatorRef.current.type = newWaveType;
                                leftOscillatorRef.current.frequency.setValueAtTime(currentLeftFreq, audioContext.currentTime);
                                leftOscillatorRef.current.connect(leftGainRef.current);
                                leftOscillatorRef.current.start();
                            }
                            
                            if (rightOscillatorRef.current) {
                                const currentRightFreq = rightFreq;
                                rightOscillatorRef.current.stop();
                                rightOscillatorRef.current.disconnect();
                                
                                rightOscillatorRef.current = audioContext.createOscillator();
                                rightOscillatorRef.current.type = newWaveType;
                                rightOscillatorRef.current.frequency.setValueAtTime(currentRightFreq, audioContext.currentTime);
                                rightOscillatorRef.current.connect(rightGainRef.current);
                                rightOscillatorRef.current.start();
                            }
                        } catch (e) {
                            console.warn('Wave type update error:', e);
                        }
                    }
                });
            }, [leftFreq, rightFreq]);

            return {
                isPlaying, leftFreq, rightFreq, leftVolume, rightVolume, waveType,
                setLeftFreq, setRightFreq, setLeftVolume, setRightVolume, setWaveType,
                startAudio, stopAudio, updateFrequency, updateVolume, applyFrequency, applyBinauralBeat,
                updateWaveType
            };
        };

        // Frequency database
        const frequencyDatabase = {
            therapeutic: [
                { name: '7.83 Hz - Schumann', freq: 7.83, description: 'Earth\'s frequency, grounding' },
                { name: '10 Hz - Alpha', freq: 10, description: 'Relaxed awareness' },
                { name: '40 Hz - Gamma', freq: 40, description: 'Enhanced focus' },
                { name: '174 Hz - Pain Relief', freq: 174, description: 'Natural anesthetic' },
                { name: '285 Hz - Healing', freq: 285, description: 'Cellular regeneration' },
                { name: '396 Hz - Liberation', freq: 396, description: 'Root chakra, fear release' },
                { name: '417 Hz - Change', freq: 417, description: 'Sacral chakra, transformation' },
                { name: '528 Hz - Love', freq: 528, description: 'Heart chakra, DNA repair' },
                { name: '639 Hz - Relationships', freq: 639, description: 'Heart chakra, connecting' },
                { name: '741 Hz - Expression', freq: 741, description: 'Throat chakra' },
                { name: '852 Hz - Intuition', freq: 852, description: 'Third eye chakra' },
                { name: '963 Hz - Divine', freq: 963, description: 'Crown chakra' }
            ],
            musical: [
                { name: 'C4 - 261.63 Hz', freq: 261.63, description: 'Middle C' },
                { name: 'D4 - 293.66 Hz', freq: 293.66, description: 'D note' },
                { name: 'E4 - 329.63 Hz', freq: 329.63, description: 'E note' },
                { name: 'F4 - 349.23 Hz', freq: 349.23, description: 'F note' },
                { name: 'G4 - 392.00 Hz', freq: 392.00, description: 'G note' },
                { name: 'A4 - 440.00 Hz', freq: 440.00, description: 'Concert pitch' },
                { name: 'B4 - 493.88 Hz', freq: 493.88, description: 'B note' },
                { name: 'C5 - 523.25 Hz', freq: 523.25, description: 'High C' }
            ],
            binaural: [
                { name: '1 Hz - Deep Sleep', left: 100, right: 101, description: 'Delta waves' },
                { name: '4 Hz - Meditation', left: 200, right: 204, description: 'Theta waves' },
                { name: '8 Hz - Alpha Relax', left: 432, right: 440, description: 'Alpha waves' },
                { name: '15 Hz - Focus', left: 440, right: 455, description: 'Beta waves' },
                { name: '40 Hz - Cognitive', left: 400, right: 440, description: 'Gamma waves' }
            ],
            brainwaves: [
                { name: '2 Hz - Delta Sleep', freq: 2, description: 'Deep sleep, healing' },
                { name: '6 Hz - Theta Dreams', freq: 6, description: 'Creativity, meditation' },
                { name: '10 Hz - Alpha Calm', freq: 10, description: 'Relaxed awareness' },
                { name: '20 Hz - Beta Alert', freq: 20, description: 'Normal consciousness' },
                { name: '40 Hz - Gamma Focus', freq: 40, description: 'High cognition' }
            ]
        };

        // Main App Component
        const App = () => {
            const audioEngine = useAudioEngine();
            const [activeTab, setActiveTab] = useState('therapeutic');
            const [searchTerm, setSearchTerm] = useState('');
            const [customFrequencies, setCustomFrequencies] = useState([]);
            const [showAddCustom, setShowAddCustom] = useState(false);
            const [customFreq, setCustomFreq] = useState('');

            const fullFrequencyDatabase = {
                custom: customFrequencies,
                ...frequencyDatabase
            };

            const filteredFrequencies = (category) => {
                // If there's a search term, search across ALL frequencies
                if (searchTerm) {
                    const allFrequencies = [];
                    Object.entries(fullFrequencyDatabase).forEach(([cat, freqs]) => {
                        freqs.forEach(item => {
                            if (item.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                item.description.toLowerCase().includes(searchTerm.toLowerCase())) {
                                // Add category info to help users understand where it comes from
                                allFrequencies.push({
                                    ...item,
                                    category: cat
                                });
                            }
                        });
                    });
                    return allFrequencies;
                } else {
                    // No search term, return frequencies for the current category
                    return fullFrequencyDatabase[category];
                }
            };

            const tabIcons = {
                custom: Settings,
                therapeutic: Heart,
                musical: Music,
                binaural: Brain,
                brainwaves: Brain
            };

            const addCustomFrequency = () => {
                const freq = parseFloat(customFreq);
                if (freq && freq >= 20 && freq <= 20000) {
                    audioEngine.applyFrequency(freq);
                    setCustomFreq('');
                }
            };

            const updateVolume = (channel, volume) => {
                if (channel === 'left') {
                    audioEngine.setLeftVolume(volume);
                } else {
                    audioEngine.setRightVolume(volume);
                }
                audioEngine.updateVolume(channel, volume);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 px-4 py-6">
                    <div className="w-full max-w-md mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden lg:max-w-4xl xl:max-w-5xl">
                        
                        {/* Debug indicator - shows Mobile on small screens, Desktop on large */}
                        <div className="bg-red-500 text-white p-2 text-center text-sm lg:bg-green-500">
                            <span className="lg:hidden">Mobile View</span>
                            <span className="hidden lg:block">Desktop View</span>
                        </div>
                        
                        {/* Desktop Layout Container */}
                        <div className="lg:flex lg:min-h-[600px]">
                        
                            {/* Left Column - Controls (Desktop) / Full Width (Mobile) */}
                            <div className="lg:w-1/2 lg:border-r border-gray-200">
                        
                        {/* Header */}
                        <div className="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 lg:p-8 text-center">
                            <div className="flex items-center justify-center gap-2 mb-2">
                                <Headphones className="w-7 h-7 lg:w-8 lg:h-8" />
                                <h1 className="text-xl lg:text-2xl xl:text-3xl font-bold">Buzzy</h1>
                            </div>
                            <p className="text-purple-100 text-sm lg:text-base">Custom sound therapy & binaural beats</p>
                            <div className="mt-3 p-2 lg:p-3 bg-yellow-400 bg-opacity-20 rounded-lg inline-block lg:block">
                                <p className="text-xs lg:text-sm text-yellow-100">
                                    🎧 Use headphones for best experience
                                </p>
                            </div>
                        </div>

                        {/* Status Display */}
                        <div className="p-4 lg:p-6 bg-gray-50 border-b">
                            <div className="flex items-center justify-between mb-3">
                                <div className="text-sm">
                                    <span className="text-blue-600 font-medium">L: {audioEngine.leftFreq} Hz</span>
                                    <span className="mx-2 text-gray-400">|</span>
                                    <span className="text-red-600 font-medium">R: {audioEngine.rightFreq} Hz</span>
                                </div>
                                <div className={`w-3 h-3 rounded-full ${audioEngine.isPlaying ? 'bg-green-500 animate-pulse' : 'bg-gray-300'}`}></div>
                            </div>
                            
                            <div className="grid grid-cols-2 gap-3">
                                <div className="bg-blue-50 p-3 rounded-xl">
                                    <div className="flex items-center gap-2 mb-2">
                                        <Volume2 className="w-4 h-4 text-blue-600" />
                                        <span className="text-xs font-medium text-blue-800">Left {Math.round(audioEngine.leftVolume * 100)}%</span>
                                    </div>
                                    <input
                                        type="range"
                                        min="0"
                                        max="0.3"
                                        step="0.01"
                                        value={audioEngine.leftVolume}
                                        onChange={(e) => {
                                            const vol = parseFloat(e.target.value);
                                            updateVolume('left', vol);
                                        }}
                                        className="w-full h-2 bg-blue-200 rounded-full appearance-none slider"
                                    />
                                </div>
                                
                                <div className="bg-red-50 p-3 rounded-xl">
                                    <div className="flex items-center gap-2 mb-2">
                                        <Volume2 className="w-4 h-4 text-red-600" />
                                        <span className="text-xs font-medium text-red-800">Right {Math.round(audioEngine.rightVolume * 100)}%</span>
                                    </div>
                                    <input
                                        type="range"
                                        min="0"
                                        max="0.3"
                                        step="0.01"
                                        value={audioEngine.rightVolume}
                                        onChange={(e) => {
                                            const vol = parseFloat(e.target.value);
                                            updateVolume('right', vol);
                                        }}
                                        className="w-full h-2 bg-red-200 rounded-full appearance-none slider"
                                    />
                                </div>
                            </div>
                        </div>

                        {/* Ad Banner 1 - After Status Display */}
                        {React.createElement(ResponsiveAdBanner, { slot: '1234567890' })}

                        {/* Main Controls */}
                        <div className="p-4 lg:p-6 border-b">
                            <div className="flex justify-center mb-4">
                                {!audioEngine.isPlaying ? (
                                    <button
                                        onClick={audioEngine.startAudio}
                                        className="flex items-center gap-2 px-8 py-4 bg-green-500 hover:bg-green-600 text-white rounded-2xl font-semibold text-lg shadow-lg active:scale-95 transition-all"
                                    >
                                        <Play className="w-6 h-6" />
                                        Start
                                    </button>
                                ) : (
                                    <button
                                        onClick={audioEngine.stopAudio}
                                        className="flex items-center gap-2 px-8 py-4 bg-red-500 hover:bg-red-600 text-white rounded-2xl font-semibold text-lg shadow-lg active:scale-95 transition-all"
                                    >
                                        <Square className="w-6 h-6" />
                                        Stop
                                    </button>
                                )}
                            </div>

                            <div className="mb-4">
                                <label className="block text-sm lg:text-base font-medium text-gray-700 mb-2">Wave Type:</label>
                                <div className="grid grid-cols-2 lg:grid-cols-4 gap-2">
                                    {['sine', 'square', 'sawtooth', 'triangle'].map((type) => (
                                        <button
                                            key={type}
                                            onClick={() => audioEngine.updateWaveType(type)}
                                            className={`py-2 px-3 text-sm rounded-xl border-2 transition-all active:scale-95 ${
                                                audioEngine.waveType === type
                                                    ? 'bg-purple-500 text-white border-purple-500 shadow-md'
                                                    : 'bg-white text-gray-700 border-gray-300'
                                            }`}
                                        >
                                            {type.charAt(0).toUpperCase() + type.slice(1)}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="mb-4">
                                <label className="block text-sm lg:text-base font-medium text-gray-700 mb-2">Quick Apply:</label>
                                <div className="flex gap-2">
                                    <input
                                        type="number"
                                        placeholder="Enter Hz (20-20000)"
                                        value={customFreq}
                                        onChange={(e) => setCustomFreq(e.target.value)}
                                        className="flex-1 px-3 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center"
                                    />
                                    <button
                                        onClick={addCustomFrequency}
                                        className="px-4 py-3 bg-purple-500 hover:bg-purple-600 text-white rounded-xl transition-all active:scale-95"
                                    >
                                        Apply
                                    </button>
                                </div>
                            </div>

                            {/* Category Tabs - Now below wave type */}
                            <div className="mb-4">
                                <label className="block text-sm lg:text-base font-medium text-gray-700 mb-2">Category:</label>
                                {/* Mobile/Tablet Grid Layout */}
                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 lg:hidden">
                                    {Object.keys(fullFrequencyDatabase).map((category) => {
                                        const Icon = tabIcons[category];
                                        return (
                                            <button
                                                key={category}
                                                onClick={() => setActiveTab(category)}
                                                className={`flex items-center justify-center gap-2 py-3 px-3 rounded-xl border-2 transition-all active:scale-95 min-h-[44px] ${
                                                    activeTab === category
                                                        ? 'bg-purple-500 text-white border-purple-500 shadow-md'
                                                        : 'bg-white text-gray-700 border-gray-300'
                                                }`}
                                            >
                                                <Icon className="w-4 h-4 flex-shrink-0" />
                                                <span className="text-sm font-medium text-center">{category.charAt(0).toUpperCase() + category.slice(1)}</span>
                                            </button>
                                        );
                                    })}
                                </div>
                                
                                {/* Desktop Vertical List Layout */}
                                <div className="hidden lg:flex lg:flex-col gap-2">
                                    {Object.keys(fullFrequencyDatabase).map((category) => {
                                        const Icon = tabIcons[category];
                                        return (
                                            <button
                                                key={category}
                                                onClick={() => setActiveTab(category)}
                                                className={`flex items-center gap-3 py-3 px-4 rounded-xl border-2 transition-all hover:scale-[1.02] active:scale-95 text-left ${
                                                    activeTab === category
                                                        ? 'bg-purple-500 text-white border-purple-500 shadow-md'
                                                        : 'bg-white text-gray-700 border-gray-300 hover:border-purple-300'
                                                }`}
                                            >
                                                <Icon className="w-5 h-5 flex-shrink-0" />
                                                <span className="text-base font-medium">{category.charAt(0).toUpperCase() + category.slice(1)}</span>
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                        
                        </div> {/* End Left Column */}
                        
                        {/* Right Column - Frequency Browser (Desktop) / Below Controls (Mobile) */}
                        <div className="lg:w-1/2 lg:flex lg:flex-col">

                        {/* Ad Banner 2 - At top of frequency browser */}
                        {React.createElement(ResponsiveAdBanner, { slot: '0987654321' })}

                        {/* Search - Now above frequency list */}
                        <div className="p-4 border-b">
                            <div className="relative">
                                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4" />
                                <input
                                    type="text"
                                    placeholder="Search frequencies..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                />
                            </div>
                        </div>

                        {/* Frequency List */}
                        <div className="max-h-96 lg:flex-1 lg:max-h-none overflow-y-auto">
                            {!searchTerm && activeTab === 'custom' && customFrequencies.length === 0 ? (
                                <div className="p-8 text-center text-gray-500">
                                    <Settings className="w-12 h-12 mx-auto mb-3 text-gray-400" />
                                    <p className="mb-2">No custom frequencies yet</p>
                                    <p className="text-sm">Use "Quick Apply" to test frequencies!</p>
                                </div>
                            ) : filteredFrequencies(activeTab).length === 0 && searchTerm ? (
                                <div className="p-8 text-center text-gray-500">
                                    <Search className="w-12 h-12 mx-auto mb-3 text-gray-400" />
                                    <p className="mb-2">No frequencies found</p>
                                    <p className="text-sm">Try a different search term</p>
                                </div>
                            ) : (
                                <div className="p-4">
                                    {filteredFrequencies(activeTab).map((item, index) => (
                                        <div key={index} className="mb-3 p-4 border border-gray-200 rounded-2xl bg-white">
                                            <div className="flex justify-between items-start mb-2">
                                                <div className="flex-1 min-w-0">
                                                    <div className="flex items-center gap-2 mb-1">
                                                        <h4 className="font-semibold text-gray-800 text-sm truncate">{item.name}</h4>
                                                        {searchTerm && item.category && (
                                                            <span className="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">
                                                                {item.category.charAt(0).toUpperCase() + item.category.slice(1)}
                                                            </span>
                                                        )}
                                                    </div>
                                                    <p className="text-xs text-gray-600 mt-1">{item.description}</p>
                                                    {((item.category === 'binaural') || (item.category === 'custom' && item.left && item.right) || (!searchTerm && activeTab === 'binaural') || (!searchTerm && activeTab === 'custom' && item.left && item.right)) && (
                                                        <p className="text-xs text-purple-600 mt-1">
                                                            L:{item.left}Hz R:{item.right}Hz Beat:{Math.abs(item.right - item.left)}Hz
                                                        </p>
                                                    )}
                                                </div>
                                            </div>
                                            
                                            <div className="flex gap-1">
                                                {((item.category === 'binaural') || (item.category === 'custom' && item.left && item.right) || (!searchTerm && activeTab === 'binaural') || (!searchTerm && activeTab === 'custom' && item.left && item.right)) ? (
                                                    <button
                                                        onClick={() => audioEngine.applyBinauralBeat(item.left, item.right)}
                                                        className="flex-1 py-2 px-3 text-xs bg-purple-500 hover:bg-purple-600 text-white rounded-xl transition-all active:scale-95"
                                                    >
                                                        Apply Both
                                                    </button>
                                                ) : (
                                                    <>
                                                        <button
                                                            onClick={() => audioEngine.applyFrequency(item.freq, 'left')}
                                                            className="flex-1 py-2 px-2 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition-all active:scale-95"
                                                        >
                                                            L
                                                        </button>
                                                        <button
                                                            onClick={() => audioEngine.applyFrequency(item.freq, 'right')}
                                                            className="flex-1 py-2 px-2 text-xs bg-red-500 hover:bg-red-600 text-white rounded-xl transition-all active:scale-95"
                                                        >
                                                            R
                                                        </button>
                                                        <button
                                                            onClick={() => audioEngine.applyFrequency(item.freq)}
                                                            className="flex-1 py-2 px-2 text-xs bg-purple-500 hover:bg-purple-600 text-white rounded-xl transition-all active:scale-95"
                                                        >
                                                            Both
                                                        </button>
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Square Ad - Before Footer */}
                        {React.createElement(SquareAd, { slot: '1122334455' })}
                        
                        </div> {/* End Right Column */}
                        </div> {/* End Desktop Layout Container */}

                        {/* Footer */}
                        <div className="p-4 lg:p-6 bg-blue-50 text-center">
                            <p className="text-xs lg:text-sm text-blue-700">
                                <strong>Tip:</strong> Different frequencies in each ear create binaural beats for brainwave entrainment
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>